define(["jquery"],function(a){var b=[],c=560;return{init:function(){if(0===a(".preferences-page-container").length&&0===a(".message-app.main").length&&(0!=a("#page-message-edit").length||0!=a("#page-message-index").length)){a(".message-app.drawer").css("visibility","visible"),a(".message-app.drawer").animate({width:"100%"},0),document.addEventListener("messages-drawer:toggle",function(){(a("#page-message-edit").length||a("#page-message-index").length)&&(a(".block_settings").hasClass("state-visible")||a(".block_settings").hasClass("state-visible")?a(window).width()<c?a(".message-app.drawer").hide():a(".message-app.drawer").animate({width:"50%"},0):a(window).width()<c?a(".message-app.drawer").show():a(".message-app.drawer").animate({width:"100%"},0))}),document.addEventListener("messages-drawer:pm-toggle",function(){(a("#page-message-edit").length||a("#page-message-index").length)&&(a(".snap-pm-open").length?a(".message-app.drawer").hide():a(".message-app.drawer").show())});var d=a("div.popover-region");d.on("popoverregion:menuopened",function(){if(a("#page-message-edit").length||a("#page-message-index").length){var d=a(this).attr("id");b.indexOf(d)==-1&&b.push(d),b.length>0&&(a(window).width()<c?a(".message-app.drawer").hide():a(".message-app.drawer").animate({width:"50%"},0))}}).bind(),d.on("popoverregion:menuclosed",function(){if(a("#page-message-edit").length||a("#page-message-index").length){var d=a(this).attr("id"),e=b.indexOf(d);b.splice(e,1),0==b.length&&(a(window).width()<c?a(".message-app.drawer").show():a(".message-app.drawer").animate({width:"100%"},0))}}).bind()}}}});